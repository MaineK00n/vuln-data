[
  {
    "DefinitionID": "oval:com.redhat.rhsa:def:20173379",
    "Title": "RHSA-2017:3379: sssd security and bug fix update (Moderate)",
    "Description": "The System Security Services Daemon (SSSD) service provides a set of daemons to manage access to remote directories and authentication mechanisms. It also provides the Name Service Switch (NSS) and the Pluggable Authentication Modules (PAM) interfaces toward the system, and a pluggable back-end system to connect to multiple different account sources.\n\nSecurity Fix(es):\n\n* It was found that sssd's sysdb_search_user_by_upn_res() function did not sanitize requests when querying its local cache and was vulnerable to injection. In a centralized login environment, if a password hash was locally cached for a given user, an authenticated attacker could use this flaw to retrieve it. (CVE-2017-12173)\n\nThis issue was discovered by Sumit Bose (Red Hat).\n\nBug Fix(es):\n\n* Previously, SSSD's krb5 provider did not respect changed UIDs in ID views overriding the default view. Consequently, Kerberos credential caches were created with the incorrect, original UID, and processes of the user were not able to find the changed UID. With this update, SSSD's krb5 provider is made aware of the proper ID view name and respects the ID override data. As a result, the Kerberos credential cache is now created with the expected UID, and the processes can find it. (BZ#1508972)\n\n* Previously, the list of cache request domains was sometimes freed in the middle of a cache request operation due to the refresh domains request, as they both were using the same list. As a consequence, a segmentation fault sometimes occurred in SSSD. With this update, SSSD uses a copy of the cache request domains' list for each cache request. As a result, SSSD no longer crashes in this case. (BZ#1509177)\n\n* Previously, the calls provided by SSSD to send data to the Privilege Attribute Certificate (PAC) responder did not use a mutex or any other means to serialize access to the PAC responder from a single process. When multithreaded applications overran the PAC responder with multiple parallel requests, some threads did not receive a proper reply. Consequently, such threads only resumed work after waiting 5 minutes for a response. This update configures mutex to serialize access to the PAC responder socket for multithreaded applications. As a result, all threads now get a proper and timely reply. (BZ#1506682)",
    "Advisory": {
      "Severity": "Moderate",
      "Cves": [
        {
          "CveID": "CVE-2017-12173",
          "Cvss2": "",
          "Cvss3": "4.3/CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
          "Cwe": "CWE-20",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2017-12173",
          "Public": "20171003"
        }
      ],
      "Bugzillas": [
        {
          "BugzillaID": "1498173",
          "URL": "https://bugzilla.redhat.com/1498173",
          "Title": "CVE-2017-12173 sssd: unsanitized input when searching in local cache database"
        }
      ],
      "AffectedCPEList": [
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:7"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:7::client"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:7::computenode"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:7::server"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:7::workstation"
        }
      ],
      "Issued": "2017-12-05T00:00:00Z",
      "Updated": "2017-12-05T00:00:00Z"
    },
    "Debian": null,
    "AffectedPacks": [
      {
        "Name": "libipa_hbac",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libipa_hbac-devel",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsss_autofs",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsss_certmap",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsss_certmap-devel",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsss_idmap",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsss_idmap-devel",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsss_nss_idmap",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsss_nss_idmap-devel",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsss_simpleifp",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsss_simpleifp-devel",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsss_sudo",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "python-libipa_hbac",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "python-libsss_nss_idmap",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "python-sss",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "python-sss-murmur",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "python-sssdconfig",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-ad",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-client",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-common",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-common-pac",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-dbus",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-ipa",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-kcm",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-krb5",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-krb5-common",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-ldap",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-libwbclient",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-libwbclient-devel",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-polkit-rules",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-proxy",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-tools",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "sssd-winbind-idmap",
        "Version": "0:1.15.2-50.el7_4.8",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      }
    ],
    "References": [
      {
        "Source": "RHSA",
        "RefID": "RHSA-2017:3379",
        "RefURL": "https://access.redhat.com/errata/RHSA-2017:3379"
      },
      {
        "Source": "CVE",
        "RefID": "CVE-2017-12173",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2017-12173"
      }
    ]
  }
]
