[
  {
    "DefinitionID": "oval:com.redhat.rhba:def:20152258",
    "Title": "RHBA-2015:2258: samba bug fix and enhancement update ()",
    "Description": "Samba is an open-source implementation of the Server Message Block (SMB) protocol and the related Common Internet File System (CIFS) protocol, which allow PC-compatible machines to share files, printers, and other information.\n\nThe samba packages have been upgraded to upstream version 4.2.3, which provides a number of bug fixes and enhancements over the previous version.\nMost notably, the \"wbinfo -u\" and \"wbinfo -g\" commands now only enumerate the users in their own domain by default. To enumerate all users on all trusted domains, run the \"wbinfo --domain='*' -u\" or \"wbinfo --domain='*' -g\" command.\n(BZ#1196140)\n\nThis update also fixes the following bugs:\n\n* Accessing a printer published in Active Directory (AD) failed with error messages. Now, if Samba fails to find the printer in the Samba registry, it obtains the globally unique identifier (GUID) of the printer from AD and stores it in the registry. The printers work as expected. (BZ#1167325)\n\n* When running Samba without the winbindd service, authentication with user name and password sometimes failed. Now, it is possible to run Samba without winbindd, although it is not recommended. (BZ#1202347)\n\n* In long-running SMB sessions, re-authenticating sometimes caused the SMB server to terminate unexpectedly. Now, the server no longer crashes during the SMB session setup. Users can re-authenticate and then use the SMB file server as expected. (BZ#1223981)\n\n* The windbindd service terminated unexpectedly with a segmentation fault when the alternative domain name was not defined and Winbind was offline. This update defines the values for the alternative domain name as well as certain other settings that were previously not set. Windbind now works as expected in offline mode. (BZ#1225719)\n\n* Samba displayed the STATUS_ACCES_DENIED message when the client tried to reconnect after the session expired because of an invalid signing check. Samba now correctly verifies whether signing is required in this situation. Samba no longer displays the message, and the user is allowed to reconnect. (BZ#1228809)\n\n* The dfree utility sometimes reported an incorrect amount of free space on a Samba share. Now, the smbd service no longer ignores the block size of dfree, thus fixing the calculation of available space. The dfree utility correctly reports the available space on a Samba share. (BZ#1238194)\n\n* The \"net ads keytab create\" command sometimes terminated unexpectedly with a segmentation fault. Samba has been modified to initialize certain internal structures and free the cursor iterating the keytab. Now, \"net ads keytab\" no longer crashes. (BZ#1246166)\n\n* The users were sometimes unable to access a Samba share that specified identical values for the force user and force group when the \"winbind use default domain = yes\" setting was used. With this update, the users can access a Samba share in the described situation as expected. (BZ#1253193)\n\n* When the \"map to guest = bad uid\" setting was used, the user was sometimes denied permission to access a share as a guest user. Samba now handles \"map to guest = bad uid\" as expected, allowing users to access shares as guest users if they are not authenticated. (BZ#1255322)\n\n* The Samba files server terminated unexpectedly when the \"mangling method = hash\" setting was used in the smb.conf file. Samba now fully initializes the hash module, preventing the file server from accessing invalid data structures, and no longer crashes in this situation. (BZ#1255326)\n\n* When the user shared an XFS file system with disk quota, Samba displayed incorrect volume size on the client. With this update, Samba correctly displays the disk quota value as the volume size. (BZ#1258293)\n\nUsers of samba are advised to upgrade to these updated packages, which fix these bugs and add these enhancements. After installing this update, the smb service will be restarted automatically.",
    "Advisory": {
      "Severity": "",
      "Cves": [
        {
          "CveID": "CVE-2015-7540",
          "Cvss2": "4.3/AV:N/AC:M/Au:N/C:N/I:N/A:P",
          "Cvss3": "",
          "Cwe": "CWE-770",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2015-7540",
          "Public": "20151216"
        }
      ],
      "Bugzillas": [
        {
          "BugzillaID": "1288451",
          "URL": "https://bugzilla.redhat.com/1288451",
          "Title": "CVE-2015-7540 samba: DoS to AD-DC due to insufficient checking of asn1 memory allocation"
        }
      ],
      "AffectedCPEList": [
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:7"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:7::client"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:7::computenode"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:7::server"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:7::workstation"
        }
      ],
      "Issued": "2015-11-19T00:00:00Z",
      "Updated": "2015-11-19T00:00:00Z"
    },
    "Debian": null,
    "AffectedPacks": [
      {
        "Name": "ctdb",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "ctdb-devel",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "ctdb-tests",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsmbclient",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libsmbclient-devel",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libwbclient",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libwbclient-devel",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-client",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-client-libs",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-common",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-common-libs",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-common-tools",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-dc",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-dc-libs",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-devel",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-libs",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-pidl",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-python",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-test",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-test-devel",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-test-libs",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-vfs-glusterfs",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-winbind",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-winbind-clients",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-winbind-krb5-locator",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "samba-winbind-modules",
        "Version": "0:4.2.3-10.el7",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      }
    ],
    "References": [
      {
        "Source": "RHSA",
        "RefID": "RHBA-2015:2258",
        "RefURL": "https://access.redhat.com/errata/RHBA-2015:2258"
      },
      {
        "Source": "CVE",
        "RefID": "CVE-2015-7540",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2015-7540"
      }
    ]
  }
]
