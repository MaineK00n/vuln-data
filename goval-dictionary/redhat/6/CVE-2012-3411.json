[
  {
    "DefinitionID": "oval:com.redhat.rhsa:def:20130276",
    "Title": "RHSA-2013:0276: libvirt security, bug fix, and enhancement update (Moderate)",
    "Description": "The libvirt library is a C API for managing and interacting with the\nvirtualization capabilities of Linux and other operating systems. In\naddition, libvirt provides tools for remote management of virtualized\nsystems.\n\nIt was discovered that libvirt made certain invalid assumptions about\ndnsmasq's command line options when setting up DNS masquerading for virtual\nmachines, resulting in dnsmasq incorrectly processing network packets from\nnetwork interfaces that were intended to be prohibited. This update\nincludes the changes necessary to call dnsmasq with a new command line\noption, which was introduced to dnsmasq via RHSA-2013:0277. (CVE-2012-3411)\n\nIn order for libvirt to be able to make use of the new command line option\n(--bind-dynamic), updated dnsmasq packages need to be installed. Refer to\nRHSA-2013:0277 for additional information.\n\nThese updated libvirt packages include numerous bug fixes and enhancements.\nSpace precludes documenting all of these changes in this advisory. Users\nare directed to the Red Hat Enterprise Linux 6.4 Technical Notes, linked\nto in the References, for information on the most significant of these\nchanges.\n\nAll users of libvirt are advised to upgrade to these updated packages,\nwhich fix these issues and add these enhancements. After installing the\nupdated packages, libvirtd must be restarted (\"service libvirtd restart\")\nfor this update to take effect.",
    "Advisory": {
      "Severity": "Moderate",
      "Cves": [
        {
          "CveID": "CVE-2012-3411",
          "Cvss2": "5.0/AV:N/AC:L/Au:N/C:N/I:N/A:P",
          "Cvss3": "",
          "Cwe": "",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2012-3411",
          "Public": "20120709"
        }
      ],
      "Bugzillas": [
        {
          "BugzillaID": "833033",
          "URL": "https://bugzilla.redhat.com/833033",
          "Title": "CVE-2012-3411 libvirt+dnsmasq: DNS configured to answer DNS queries from non-virtual networks"
        }
      ],
      "AffectedCPEList": [
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:6"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:6::client"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:6::computenode"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:6::server"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:6::workstation"
        }
      ],
      "Issued": "2013-02-20T00:00:00Z",
      "Updated": "2013-02-21T00:00:00Z"
    },
    "Debian": null,
    "AffectedPacks": [
      {
        "Name": "libvirt",
        "Version": "0:0.10.2-18.el6",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libvirt-client",
        "Version": "0:0.10.2-18.el6",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libvirt-devel",
        "Version": "0:0.10.2-18.el6",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libvirt-lock-sanlock",
        "Version": "0:0.10.2-18.el6",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "libvirt-python",
        "Version": "0:0.10.2-18.el6",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      }
    ],
    "References": [
      {
        "Source": "RHSA",
        "RefID": "RHSA-2013:0276",
        "RefURL": "https://access.redhat.com/errata/RHSA-2013:0276"
      },
      {
        "Source": "CVE",
        "RefID": "CVE-2012-3411",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2012-3411"
      }
    ]
  },
  {
    "DefinitionID": "oval:com.redhat.rhsa:def:20130277",
    "Title": "RHSA-2013:0277: dnsmasq security, bug fix and enhancement update (Moderate)",
    "Description": "The dnsmasq packages contain Dnsmasq, a lightweight DNS (Domain Name\nServer) forwarder and DHCP (Dynamic Host Configuration Protocol) server.\n\nIt was discovered that dnsmasq, when used in combination with certain\nlibvirtd configurations, could incorrectly process network packets from\nnetwork interfaces that were intended to be prohibited. A remote,\nunauthenticated attacker could exploit this flaw to cause a denial of\nservice via DNS amplification attacks. (CVE-2012-3411)\n\nIn order to fully address this issue, libvirt package users are advised to\ninstall updated libvirt packages. Refer to RHSA-2013:0276 for additional\ninformation.\n\nThis update also fixes the following bug:\n\n* Due to a regression, the lease change script was disabled. Consequently,\nthe \"dhcp-script\" option in the /etc/dnsmasq.conf configuration file did\nnot work. This update corrects the problem and the \"dhcp-script\" option now\nworks as expected. (BZ#815819)\n\nThis update also adds the following enhancements:\n\n* Prior to this update, dnsmasq did not validate that the tftp directory\ngiven actually existed and was a directory. Consequently, configuration\nerrors were not immediately reported on startup. This update improves the\ncode to validate the tftp root directory option. As a result, fault finding\nis simplified especially when dnsmasq is called by external processes such\nas libvirt. (BZ#824214)\n\n* The dnsmasq init script used an incorrect Process Identifier (PID) in the\n\"stop\", \"restart\", and \"condrestart\" commands. Consequently, if there were\nsome dnsmasq instances running besides the system one started by the init\nscript, then repeated calling of \"service dnsmasq\" with \"stop\" or \"restart\"\nwould kill all running dnsmasq instances, including ones not started with\nthe init script. The dnsmasq init script code has been corrected to obtain\nthe correct PID when calling the \"stop\", \"restart\", and \"condrestart\"\ncommands. As a result, if there are dnsmasq instances running in addition\nto the system one started by the init script, then by calling \"service\ndnsmasq\" with \"stop\" or \"restart\" only the system one is stopped or\nrestarted. (BZ#850944)\n\n* When two or more dnsmasq processes were running with DHCP enabled on one\ninterface, DHCP RELEASE packets were sometimes lost. Consequently, when two\nor more dnsmasq processes were running with DHCP enabled on one interface,\nreleasing IP addresses sometimes failed. This update sets the\nSO_BINDTODEVICE socket option on DHCP sockets if running dnsmasq with DHCP\nenabled on one interface. As a result, when two or more dnsmasq processes\nare running with DHCP enabled on one interface, they can release IP\naddresses as expected. (BZ#887156)\n\nAll users of dnsmasq are advised to upgrade to these updated packages,\nwhich fix these issues and add these enhancements.",
    "Advisory": {
      "Severity": "Moderate",
      "Cves": [
        {
          "CveID": "CVE-2012-3411",
          "Cvss2": "5.0/AV:N/AC:L/Au:N/C:N/I:N/A:P",
          "Cvss3": "",
          "Cwe": "",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2012-3411",
          "Public": "20120709"
        }
      ],
      "Bugzillas": [
        {
          "BugzillaID": "833033",
          "URL": "https://bugzilla.redhat.com/833033",
          "Title": "CVE-2012-3411 libvirt+dnsmasq: DNS configured to answer DNS queries from non-virtual networks"
        }
      ],
      "AffectedCPEList": [
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:6"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:6::client"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:6::computenode"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:6::server"
        },
        {
          "Cpe": "cpe:/o:redhat:enterprise_linux:6::workstation"
        }
      ],
      "Issued": "2013-02-20T00:00:00Z",
      "Updated": "2013-02-21T00:00:00Z"
    },
    "Debian": null,
    "AffectedPacks": [
      {
        "Name": "dnsmasq",
        "Version": "0:2.48-13.el6",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      },
      {
        "Name": "dnsmasq-utils",
        "Version": "0:2.48-13.el6",
        "Arch": "",
        "NotFixedYet": false,
        "ModularityLabel": ""
      }
    ],
    "References": [
      {
        "Source": "RHSA",
        "RefID": "RHSA-2013:0277",
        "RefURL": "https://access.redhat.com/errata/RHSA-2013:0277"
      },
      {
        "Source": "CVE",
        "RefID": "CVE-2012-3411",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2012-3411"
      }
    ]
  }
]
