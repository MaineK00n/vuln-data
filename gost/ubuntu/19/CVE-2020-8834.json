{
  "public_data_at_usn": "2020-04-06T16:00:00Z",
  "crd": "2020-04-06T16:00:00Z",
  "candidate": "CVE-2020-8834",
  "public_date": "2020-04-09T22:15:00Z",
  "references": [
    {
      "reference": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8834"
    },
    {
      "reference": "https://www.openwall.com/lists/oss-security/2020/04/06/2"
    },
    {
      "reference": "https://ubuntu.com/security/notices/USN-4318-1"
    }
  ],
  "description": "KVM in the Linux kernel on Power8 processors has a conflicting use of HSTATE_HOST_R1 to store r1 state in kvmppc_hv_entry plus in kvmppc_{save,restore}_tm, leading to a stack corruption. Because of this, an attacker with the ability run code in kernel space of a guest VM can cause the host kernel to panic. There were two commits that, according to the reporter, introduced the vulnerability: f024ee098476 (\"KVM: PPC: Book3S HV: Pull out TM state save/restore into separate procedures\") 87a11bb6a7f7 (\"KVM: PPC: Book3S HV: Work around XER[SO] bug in fake suspend mode\") The former landed in 4.8, the latter in 4.17. This was fixed without realizing the impact in 4.18 with the following three commits, though it's believed the first is the only strictly necessary commit: 6f597c6b63b6 (\"KVM: PPC: Book3S PR: Add guest MSR parameter for kvmppc_save_tm()/kvmppc_restore_tm()\") 7b0e827c6970 (\"KVM: PPC: Book3S HV: Factor fake-suspend handling out of kvmppc_save/restore_tm\") 009c872a8bc4 (\"KVM: PPC: Book3S PR: Move kvmppc_save_tm/kvmppc_restore_tm to separate file\")",
  "ubuntu_description": "Gustavo Romero and Paul Mackerras discovered that the KVM implementation in the Linux kernel for PowerPC processors did not properly keep guest state separate from host state. A local attacker in a KVM guest could use this to cause a denial of service (host system crash).",
  "notes": [
    {
      "note": "sbeattie\u003e appears to only affect Power8 hardware and not Power9, possibly because transaction memory in Power9 needs a software assist to function."
    },
    {
      "note": "sbeattie\u003e from reporter, introduced in f024ee098476 and exacerbated by 87a11bb6a7f7."
    },
    {
      "note": "sbeattie| Addressed by: 7b0e827c6970e8ca77c60ae87592204c39e41245 KVM: PPC: Book3S HV: Factor fake-suspend handling out of kvmppc_save/restore_tm 009c872a8bc4d38f487a9bd62423d019e4322517 KVM: PPC: Book3S PR: Move kvmppc_save_tm/kvmppc_restore_tm to separate file 6f597c6b63b6f3675914b5ec8fcd008a58678650 KVM: PPC: Book3S PR: Add guest MSR parameter for kvmppc_save_tm()/kvmppc_restore_tm()"
    }
  ],
  "bugs": [
    {
      "bug": "https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1867717"
    }
  ],
  "priority": "medium",
  "discovered_by": "Gustavo Romero and Paul Mackerras",
  "assigned_to": "",
  "patches": [
    {
      "package_name": "linux-azure",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "not-affected",
          "note": "v4.15 kernels only"
        }
      ]
    },
    {
      "package_name": "linux-raspi2",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "not-affected",
          "note": "ppc kernels only"
        }
      ]
    },
    {
      "package_name": "linux-raspi2-5.3",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-aws-hwe",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-gcp-edge",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-gke-5.0",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-gke-5.3",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-lts-trusty",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "not-affected",
          "note": "v4.15 kernels only"
        }
      ]
    },
    {
      "package_name": "linux-aws",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "not-affected",
          "note": "v4.15 kernels only"
        }
      ]
    },
    {
      "package_name": "linux-aws-5.0",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-hwe-edge",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-oem",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "not-affected",
          "note": "ppc kernels only"
        }
      ]
    },
    {
      "package_name": "linux-snapdragon",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-hwe",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-oracle-5.3",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-azure-5.3",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-oracle",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "not-affected",
          "note": "v4.15 kernels only"
        }
      ]
    },
    {
      "package_name": "linux-azure-edge",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-gcp",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "not-affected",
          "note": "v4.15 kernels only"
        }
      ]
    },
    {
      "package_name": "linux-gke-4.15",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-kvm",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "not-affected",
          "note": "v4.15 kernels only"
        }
      ]
    },
    {
      "package_name": "linux-oem-osp1",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "not-affected",
          "note": "v4.15 kernels only"
        }
      ]
    },
    {
      "package_name": "linux-gcp-5.3",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-lts-xenial",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-oem-5.4",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    },
    {
      "package_name": "linux-oracle-5.0",
      "release_patches": [
        {
          "release_name": "eoan",
          "status": "DNE",
          "note": ""
        }
      ]
    }
  ],
  "upstreams": []
}
