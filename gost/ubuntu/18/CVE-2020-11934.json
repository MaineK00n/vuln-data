{
  "public_data_at_usn": "2020-07-15T12:00:00Z",
  "crd": "2020-07-15T12:00:00Z",
  "candidate": "CVE-2020-11934",
  "public_date": "2020-07-29T17:15:00Z",
  "references": [
    {
      "reference": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11934"
    },
    {
      "reference": "https://ubuntu.com/security/notices/USN-4424-1"
    }
  ],
  "description": "It was discovered that snapctl user-open allowed altering the $XDG_DATA_DIRS environment variable when calling the system xdg-open. OpenURL() in usersession/userd/launcher.go would alter $XDG_DATA_DIRS to append a path to a directory controlled by the calling snap. A malicious snap could exploit this to bypass intended access restrictions to control how the host system xdg-open script opens the URL and, for example, execute a script shipped with the snap without confinement. This issue did not affect Ubuntu Core systems. Fixed in snapd versions 2.45.1ubuntu0.2, 2.45.1+18.04.2 and 2.45.1+20.04.2.",
  "ubuntu_description": "It was discovered that snapctl user-open allowed altering the $XDG_DATA_DIRS environment variable when calling the system xdg-open. A malicious snap could exploit this to bypass intended access restrictions to control how the host system xdg-open script opens the URL. This issue did not affect Ubuntu Core systems. (CVE-2020-11934)",
  "notes": [
    {
      "note": "emitorino\u003e Since the vulnerability is present on the userd's OpenURL implementation, it only affects classic distros where userd is auto-started."
    },
    {
      "note": "emitorino\u003e Since userd cannot be auto-started on Ubuntu Core 16, Ubuntu Core 18 or Ubuntu Core 20 (for various reasons depending on the release), then Ubuntu Core is not affected."
    },
    {
      "note": "emitorino\u003e Even if userd happened to start (eg, the user started it manually on UC20) there is no implicitOnCore policy that allows communicating with io.snapcraft.Launcher (or the older com.canonical.SafeLauncher)."
    },
    {
      "note": "emitorino\u003e The dbus interface can't be used (with either plugs or slots) to communicate with userd."
    },
    {
      "note": "emitorino\u003e /usr/bin/xdg-open on the boot file system of an Ubuntu Core system is different to Classic: it is the sandbox proxy that calls back into userd. Even if a session bus is running and a confined app could call userd, userd will report an error because the caller is not confined"
    }
  ],
  "bugs": [
    {
      "bug": "https://bugs.launchpad.net/snapd/+bug/1880085"
    }
  ],
  "priority": "medium",
  "discovered_by": "James Henstridge",
  "assigned_to": "emitorino",
  "patches": [
    {
      "package_name": "snapd",
      "release_patches": [
        {
          "release_name": "bionic",
          "status": "released",
          "note": "2.45.1+18.04.2"
        }
      ]
    }
  ],
  "upstreams": [
    {
      "package_name": "snapd",
      "upstream_links": [
        {
          "link": "https://github.com/snapcore/snapd/commit/06342a31878f1cf99d56da5483e71b9af61f46ad"
        }
      ]
    }
  ]
}
