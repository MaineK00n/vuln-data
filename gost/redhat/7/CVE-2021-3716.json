{
  "ThreatSeverity": "Low",
  "PublicDate": "2021-08-16T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2021-3716 nbdkit: NBD_OPT_STRUCTURED_REPLY injection on STARTTLS",
    "id": "1994695",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1994695"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "3.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:L",
    "status": "draft"
  },
  "Iava": "",
  "Cwe": "CWE-924",
  "Statement": "Red Hat Enterprise Linux 7 is not affected by this flaw as it ships an old version of `nbdkit` (v1.8.0) that does not include support for NBD Structured Replies.",
  "Acknowledgement": "This issue was discovered by Eric Blake (Red Hat).",
  "Mitigation": "In general, it is recommended to use forced TLS (--tls=require) to avoid MitM attacks in the first place. If opportunistic encryption must be used (--tls=yes), ensure that clients that want to use TLS will request structured replies after the encryption is enabled. If this cannot be done, apply network filtering (e.g., firewall, TCP wrappers, etc.) or use a Unix domain socket instead of TCP to ensure that untrusted clients cannot connect to nbdkit as a MitM attacker.",
  "AffectedRelease": [],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "nbdkit",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "Name": "CVE-2021-3716",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "A flaw was found in nbdkit due to to improperly caching plaintext state across the STARTTLS encryption boundary. A MitM attacker could use this flaw to inject a plaintext NBD_OPT_STRUCTURED_REPLY before proxying everything else a client sends to the server, potentially leading the client to terminate the NBD session. The highest threat from this vulnerability is to system availability."
    }
  ],
  "References": [
    {
      "Reference": "https://listman.redhat.com/archives/libguestfs/2021-August/msg00083.html\nhttps://www.openwall.com/lists/oss-security/2021/08/18/2"
    }
  ]
}
