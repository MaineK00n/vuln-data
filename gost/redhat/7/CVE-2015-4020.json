{
  "ThreatSeverity": "Important",
  "PublicDate": "2015-05-18T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2015-4020 rubygems: incomplete fix for CVE-2015-3900",
    "id": "1250109",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1250109"
  },
  "Cvss": {
    "cvss_base_score": "7.9",
    "cvss_scoring_vector": "AV:A/AC:M/Au:N/C:C/I:C/A:C",
    "status": "draft"
  },
  "Cvss3": {
    "cvss3_base_score": "",
    "cvss3_scoring_vector": "",
    "status": ""
  },
  "Iava": "",
  "Cwe": "CWE-20-\u003eCWE-345",
  "Statement": "This issue did not affect the versions of rubygems as shipped with Red Hat Enterprise Linux 6, Red Hat Enterprise MRG 2.5, Red Hat Satellite 6, Red Hat Openstack 5, Red Hat Openshift Enterprise 2, as the packages did not include the incomplete fix.\nThis issue did not affect the versions of ruby as shipped with Red Hat Enterprise Linux 5, 6 and 7, Red Hat Subscription Asset Manager and Red Hat Software Collections, as the packages did not include the incomplete fix.",
  "Acknowledgement": "",
  "Mitigation": "",
  "AffectedRelease": [],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "ruby",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "Name": "CVE-2015-4020",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "RubyGems 2.0.x before 2.0.17, 2.2.x before 2.2.5, and 2.4.x before 2.4.8 does not validate the hostname when fetching gems or making API requests, which allows remote attackers to redirect requests to arbitrary domains via a crafted DNS SRV record with a domain that is suffixed with the original domain name, aka a \"DNS hijack attack.\" NOTE: this vulnerability exists because to an incomplete fix for CVE-2015-3900."
    },
    {
      "Detail": "A flaw was found in a way rubygems verified the API endpoint hostname retrieved through a DNS SRV record. A man-in-the-middle attacker could use this flaw to force a client to download content from an untrusted domain."
    }
  ],
  "References": []
}
