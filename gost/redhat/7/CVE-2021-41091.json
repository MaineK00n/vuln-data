{
  "ThreatSeverity": "Moderate",
  "PublicDate": "2021-10-04T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2021-41091 moby: data directory contains subdirectories with insufficiently restricted permissions, which could lead to directory traversal",
    "id": "2023448",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2023448"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "6.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L",
    "status": "draft"
  },
  "Iava": "",
  "Cwe": "CWE-281",
  "Statement": "In the OpenShift Container Platform (OCP),  the Migration Toolkit for Virtualization (MTV) and the Red Hat Advanced Cluster Management for Kubernetes (RHACM) some components bundle github.com/moby/moby. However, successful exploitation requires direct access to the cluster hosts, which is not allowed by default and is available only to the cluster administrators, so the impact of this vulnerability to these components is Low.\nStarting in OCP 4.7 the github.com/moby/moby is not shipped anymore in the openshift4-wincw/windows-machine-config-rhel8-operator component (Red Hat OpenShift Container Platform for Windows Containers version 2) , hence this component is marked as Will not fix.",
  "Acknowledgement": "",
  "Mitigation": "",
  "AffectedRelease": [],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "docker",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "Name": "CVE-2021-41091",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "Moby is an open-source project created by Docker to enable software containerization. A bug was found in Moby (Docker Engine) where the data directory (typically `/var/lib/docker`) contained subdirectories with insufficiently restricted permissions, allowing otherwise unprivileged Linux users to traverse directory contents and execute programs. When containers included executable programs with extended permission bits (such as `setuid`), unprivileged Linux users could discover and execute those programs. When the UID of an unprivileged Linux user on the host collided with the file owner or group inside a container, the unprivileged Linux user on the host could discover, read, and modify those files. This bug has been fixed in Moby (Docker Engine) 20.10.9. Users should update to this version as soon as possible. Running containers should be stopped and restarted for the permissions to be fixed. For users unable to upgrade limit access to the host to trusted users. Limit access to host volumes to trusted containers."
    },
    {
      "Detail": "A file permissions vulnerability was found in the Moby (Docker Engine). The Moby data directory (usually /var/lib/docker) contains subdirectories with insufficiently restricted permissions, allowing unprivileged Linux users to traverse directory contents and execute programs. When the running container contains executable programs with the extended permission bits (like setuid), unprivileged Linux users can discover and execute those programs. Additionally, when the UID of an unprivileged Linux user on the host collides with the file owner or group inside a container, the unprivileged Linux user on the host can discover, read, and modify those files. The highest threat from this vulnerability is to confidentiality, integrity, as well as system availability."
    }
  ],
  "References": [
    {
      "Reference": "https://github.com/moby/moby/commit/f0ab919f518c47240ea0e72d0999576bb8008e64\nhttps://github.com/moby/moby/security/advisories/GHSA-3fwx-pjgw-3558"
    }
  ]
}
