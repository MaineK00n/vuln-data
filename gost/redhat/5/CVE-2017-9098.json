{
  "ThreatSeverity": "Moderate",
  "PublicDate": "2017-05-18T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2017-9098 ImageMagick: use of uninitialized memory in RLE decoder",
    "id": "1453124",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1453124"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "5.1",
    "cvss3_scoring_vector": "CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "status": "draft"
  },
  "Iava": "",
  "Cwe": "CWE-456",
  "Statement": "Red Hat Product Security has rated this issue as having Moderate security impact. This issue is not currently planned to be addressed in future updates. For additional information, refer to the Issue Severity Classification: https://access.redhat.com/security/updates/classification/.",
  "Acknowledgement": "",
  "Mitigation": "Forcefully disable the RLE decoder from being used, for example by renaming ImageMagick's rle.so library:\nRHEL6 mitigation:\n32bit:\nmv /usr/lib/ImageMagick-6.7.2/modules-Q16/coders/rle.so /usr/lib/ImageMagick-6.7.2/modules-Q16/coders/rle.so.CVE-2017-9098\n64bit:\nmv /usr/lib64/ImageMagick-6.7.2/modules-Q16/coders/rle.so /usr/lib64/ImageMagick-6.7.2/modules-Q16/coders/rle.so.CVE-2017-9098\nRHEL7 mitigation:\n32bit:\nmv /usr/lib/ImageMagick-6.7.8/modules-Q16/coders/rle.so /usr/lib/ImageMagick-6.7.8/modules-Q16/coders/rle.so.CVE-2017-9098\n64bit:\nmv /usr/lib64/ImageMagick-6.7.8/modules-Q16/coders/rle.so /usr/lib64/ImageMagick-6.7.8/modules-Q16/coders/rle.so.CVE-2017-9098\nIf you are using the glibc heap implementation (default), it may also be possible to set the \"MALLOC_PERTURB_\" environment variable to a non-zero value before launching the process using ImageMagick. This should forcefully initialize the memory, but may reduce performance. Ensure proper testing before using these methods.",
  "AffectedRelease": [],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Will not fix",
      "package_name": "ImageMagick",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    }
  ],
  "Name": "CVE-2017-9098",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "ImageMagick before 7.0.5-2 and GraphicsMagick before 1.3.24 use uninitialized memory in the RLE decoder, allowing an attacker to leak sensitive information from process memory space, as demonstrated by remote attacks against ImageMagick code in a long-running server process that converts image data on behalf of multiple users. This is caused by a missing initialization step in the ReadRLEImage function in coders/rle.c."
    },
    {
      "Detail": "It was discovered that ImageMagick does not properly guarantee that initialized memory is used when reading RLE images. A remote attacker could possibly exploit this flaw to disclose potentially sensitive memory contents by, for example, tricking ImageMagick into converting a specially crafted RLE image into another format."
    }
  ],
  "References": [
    {
      "Reference": "https://scarybeastsecurity.blogspot.com/2017/05/bleed-continues-18-byte-file-14k-bounty.html"
    }
  ]
}
