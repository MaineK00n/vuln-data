{
  "ThreatSeverity": "Moderate",
  "PublicDate": "2017-09-20T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2017-12151 samba: SMB2 connections don't keep encryption across DFS redirects",
    "id": "1488197",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1488197"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "7.4",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
    "status": "verified"
  },
  "Iava": "",
  "Cwe": "CWE-300",
  "Statement": "The samba4 package in Red Hat Enterprise Linux 6, is a tech preview and by default uses the SMB1 protocol, therefore though affected by this flaw, will not be addressed in a security update.",
  "Acknowledgement": "Red Hat would like to thank the Samba project for reporting this issue. Upstream acknowledges Stefan Metzmacher (SerNet) as the original reporter.",
  "Mitigation": "Keep the default of \"client max protocol = NT1\".",
  "AffectedRelease": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2017-09-21T00:00:00Z",
      "advisory": "RHSA-2017:2790",
      "package": "samba-0:4.6.2-11.el7_4",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.3 for RHEL 6",
      "release_date": "2017-10-04T00:00:00Z",
      "advisory": "RHSA-2017:2858",
      "package": "samba-0:4.6.3-6.el6rhs",
      "cpe": "cpe:/a:redhat:storage:3"
    },
    {
      "product_name": "Red Hat Gluster Storage 3.3 for RHEL 7",
      "release_date": "2017-10-04T00:00:00Z",
      "advisory": "RHSA-2017:2858",
      "package": "samba-0:4.6.3-6.el7rhgs",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "samba",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "samba3x",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    }
  ],
  "Name": "CVE-2017-12151",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "A flaw was found in the way samba client before samba 4.4.16, samba 4.5.14 and samba 4.6.8 used encryption with the max protocol set as SMB3. The connection could lose the requirement for signing and encrypting to any DFS redirects, allowing an attacker to read or alter the contents of the connection via a man-in-the-middle attack."
    },
    {
      "Detail": "A flaw was found in the way samba client used encryption with the max protocol set as SMB3. The connection could lose the requirement for signing and encrypting to any DFS redirects, allowing an attacker to read or alter the contents of the connection via a man-in-the-middle attack."
    }
  ],
  "References": [
    {
      "Reference": "https://www.samba.org/samba/security/CVE-2017-12151.html"
    }
  ]
}
