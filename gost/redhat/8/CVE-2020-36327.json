{
  "ThreatSeverity": "Important",
  "PublicDate": "2021-02-09T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2020-36327 rubygem-bundler: Dependencies of gems with explicit source may be installed from a different source",
    "id": "1958999",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1958999"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "8.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "Iava": "",
  "Cwe": "CWE-494",
  "Statement": "Red Hat Satellite does not ship RubyGem bundler, however, the product consumes it from the Red Hat Software Collections (RHSCL) repository.",
  "Acknowledgement": "",
  "Mitigation": "This issue only affects configurations where gem packages are installed from multiple sources and the source repositories are explicitly defined for at least some gems. Dependencies of those source-restricted gems may be installed form a different repository, even if the same repository provides those dependencies, which is inconsistent with the intended behaviour described in the Bundler documentation.  There are multiple possible approaches to mitigate this issue - customers should evaluate which approaches are usable in their environments.\n* Explicitly define source for all dependency gems in the Gemfile configuration. When a dependency of a source-restricted gem is also to be installed form the same source, list such dependency explicitly in the Gemfile along with the specific source.\n* Avoid configurations with multiple source repositories. When using a private repository for non-public gems, use the same private repository to mirror any content required from any public gem repository, such as RubyGems.org. When preparing such mirror, ensure that no mirrored gems have names conflicting with names of the internal non-public gems.\n* Reserve internal package names in public repositories. For any internal private gem, also reserve the name in any public gem repository used, such as RubyGems.org. This will prevent attackers from registering those names and providing their malicious gems with higher versions.\nAdditional information about affected configurations can be found in the following Red Hat Knowledgebase article:\nhttps://access.redhat.com/articles/6206172",
  "AffectedRelease": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-08-05T00:00:00Z",
      "advisory": "RHSA-2021:3020",
      "package": "ruby:2.7-8040020210728141159.522a0ee4",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2021-09-20T00:00:00Z",
      "advisory": "RHSA-2021:3559",
      "package": "rh-ruby27-ruby-0:2.7.4-130.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2021-10-25T00:00:00Z",
      "advisory": "RHSA-2021:3982",
      "package": "rh-ruby30-ruby-0:3.0.2-148.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2021-09-20T00:00:00Z",
      "advisory": "RHSA-2021:3559",
      "package": "rh-ruby27-ruby-0:2.7.4-130.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2021-10-25T00:00:00Z",
      "advisory": "RHSA-2021:3982",
      "package": "rh-ruby30-ruby-0:3.0.2-148.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "ruby:2.5/rubygem-bundler",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "ruby:2.6/ruby",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "Name": "CVE-2020-36327",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "Bundler 1.16.0 through 2.2.9 and 2.2.11 through 2.2.16 sometimes chooses a dependency source based on the highest gem version number, which means that a rogue gem found at a public source may be chosen, even if the intended choice was a private gem that is a dependency of another private gem that is explicitly depended on by the application. NOTE: it is not correct to use CVE-2021-24105 for every \"Dependency Confusion\" issue in every product."
    },
    {
      "Detail": "A flaw was found in the way Bundler determined the source repository when installing dependencies of source-restricted gem packages. In configurations that use multiple gem repositories and explicitly define from which source repository certain gems are to be installed, a dependency of a source-restricted gem could be installed form a different source if that repository provided higher version of the package. This could lead to installation of a malicious gem version and arbitrary code execution."
    }
  ],
  "References": [
    {
      "Reference": "https://access.redhat.com/articles/6206172\nhttps://www.zofrex.com/blog/2021/04/29/bundler-still-vulnerable-dependency-confusion-cve-2020-36327/"
    }
  ]
}
