{
  "ThreatSeverity": "Moderate",
  "PublicDate": "2021-02-22T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2021-21309 redis: integer overflow when configurable limit for maximum supported bulk input size is too big on 32-bit platforms",
    "id": "1932634",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1932634"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "8.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "Iava": "",
  "Cwe": "CWE-190-\u003eCWE-120",
  "Statement": "This issue only affects 32-bit Redis. Red Hat Enterprise Linux 8 and Red Hat Software Collections are not affected by this issue because they do not provide support for 32-bit Redis. The following products are not affected because the vulnerable component (Redis 4.0) is not being consumed:\n* Red Hat Ansible Automation Platform\n* Red Hat Ansible Tower\n* Red Hat OpenStack Platform",
  "Acknowledgement": "",
  "Mitigation": "As recommended in the upstream advisory, this issue can be mitigated by preventing clients from directly executing `CONFIG SET`:\n* Using Redis 6.0 or newer, ACL configuration can be used to block the command.\n* Using older versions, the `rename-command` configuration directive can be used to rename the command to a random string unknown to users, rendering it inaccessible.",
  "AffectedRelease": [
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.2 for RHEL 8",
      "release_date": "2021-06-16T00:00:00Z",
      "advisory": "RHSA-2021:2461",
      "package": "rhacm2/redisgraph-tls-rhel8:v2.2.4-7",
      "cpe": "cpe:/a:redhat:acm:2.2::el8"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 7",
      "release_date": "2021-08-06T00:00:00Z",
      "advisory": "RHSA-2021:3016",
      "package": "rhacm2/management-ingress-rhel7:v2.3.0-36",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 7",
      "release_date": "2021-08-06T00:00:00Z",
      "advisory": "RHSA-2021:3016",
      "package": "rhacm2/memcached-exporter-rhel7:v2.3.0-21",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2.3 for RHEL 7",
      "release_date": "2021-08-06T00:00:00Z",
      "advisory": "RHSA-2021:3016",
      "package": "rhacm2/thanos-rhel7:v2.3.0-36",
      "cpe": "cpe:/a:redhat:acm:2"
    }
  ],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "redis:5/redis",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "redis:6/redis",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "Name": "CVE-2021-21309",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "Redis is an open-source, in-memory database that persists on disk. In affected versions of Redis an integer overflow bug in 32-bit Redis version 4.0 or newer could be exploited to corrupt the heap and potentially result with remote code execution. Redis 4.0 or newer uses a configurable limit for the maximum supported bulk input size. By default, it is 512MB which is a safe value for all platforms. If the limit is significantly increased, receiving a large request from a client may trigger several integer overflow scenarios, which would result with buffer overflow and heap corruption. We believe this could in certain conditions be exploited for remote code execution. By default, authenticated Redis users have access to all configuration parameters and can therefore use the “CONFIG SET proto-max-bulk-len” to change the safe default, making the system vulnerable. **This problem only affects 32-bit Redis (on a 32-bit system, or as a 32-bit executable running on a 64-bit system).** The problem is fixed in version 6.2, and the fix is back ported to 6.0.11 and 5.0.11. Make sure you use one of these versions if you are running 32-bit Redis. An additional workaround to mitigate the problem without patching the redis-server executable is to prevent clients from directly executing `CONFIG SET`: Using Redis 6.0 or newer, ACL configuration can be used to block the command. Using older versions, the `rename-command` configuration directive can be used to rename the command to a random string unknown to users, rendering it inaccessible. Please note that this workaround may have an additional impact on users or operational systems that expect `CONFIG SET` to behave in certain ways."
    },
    {
      "Detail": "An integer overflow was found in Redis. Redis 4.0 or newer uses a configurable limit for the maximum supported bulk input size. The default size is 512MB which is a safe value for all platforms. Authenticated Redis users could increase the bulk input size by changing the \"proto-max-bulk-len\" configuration parameter, leading to heap corruption and potentially remote code execution."
    }
  ],
  "References": [
    {
      "Reference": "https://github.com/redis/redis/security/advisories/GHSA-hgj8-vff2-7cjf"
    }
  ]
}
