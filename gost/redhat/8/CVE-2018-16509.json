{
  "ThreatSeverity": "Important",
  "PublicDate": "2018-08-21T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2018-16509 ghostscript: /invalidaccess bypass after failed restore (699654)",
    "id": "1619748",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1619748"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "7.3",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "status": "verified"
  },
  "Iava": "",
  "Cwe": "",
  "Statement": "This issue did affect the versions of ghostscript as shipped with Red Hat Enterprise Linux 5, 6, and 7. \nRed Hat Enterprise Linux 5 is now in Extended Life Phase of the support and maintenance life cycle. This issue is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle: https://access.redhat.com/support/policy/updates/errata/.",
  "Acknowledgement": "Red Hat would like to thank Tavis Ormandy (Google Project Zero) for reporting this issue.",
  "Mitigation": "* ImageMagick relies on ghostscript when processing certain files formats. Thus, ImageMagick can be used as an attack vector. In order to prevent ImageMagick from processing those files on Red Hat Enterprise Linux 6 and 7, you can disable the use of ghostscript and the processing of PS, EPS, PDF, and XPS file formats in ImageMagick's security policy by opening /etc/ImageMagick/policy.xml and adding the following lines to the \"\u003cpolicymap\u003e\" section of the file:\n```\n\u003cpolicy domain=\"coder\" rights=\"none\" pattern=\"PS\" /\u003e\n\u003cpolicy domain=\"coder\" rights=\"none\" pattern=\"EPS\" /\u003e\n\u003cpolicy domain=\"coder\" rights=\"none\" pattern=\"PDF\" /\u003e\n\u003cpolicy domain=\"coder\" rights=\"none\" pattern=\"XPS\" /\u003e\n\u003cpolicy domain=\"delegate\" rights=\"none\" pattern=\"gs\" /\u003e\n```\n* Additionally, this issue can be triggered when processing files in order to generate thumbnails, for example when browsing a folder containing a malicious PostScript file in Nautilus. To prevent this, remove or rename the \"/usr/bin/evince-thumbnailer\" executable.\nIn Red Hat Enterprise Linux v.7.6 and above, the thumbnailing is done in a sandbox.\n* It is possible to run PDF/PS viewers, such as evince and okular, in a SELinux sandbox using the `sandbox` command from the policycoreutils-sandbox package :\n$ sandbox -X evince \u003cuntrusted-file.pdf\u003e\nThe sandbox will prevent an attacker to make modifications on the file system.",
  "AffectedRelease": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2018-12-03T00:00:00Z",
      "advisory": "RHSA-2018:3760",
      "package": "ghostscript-0:8.70-24.el6_10.2",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2018-10-16T00:00:00Z",
      "advisory": "RHSA-2018:2918",
      "package": "ghostscript-0:9.07-29.el7_5.2",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "ghostscript",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "Name": "CVE-2018-16509",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "An issue was discovered in Artifex Ghostscript before 9.24. Incorrect \"restoration of privilege\" checking during handling of /invalidaccess exceptions could be used by attackers able to supply crafted PostScript to execute code using the \"pipe\" instruction."
    },
    {
      "Detail": "It was discovered that the ghostscript /invalidaccess checks fail under certain conditions. An attacker could possibly exploit this to bypass the -dSAFER protection and, for example, execute arbitrary shell commands via a specially crafted PostScript document."
    }
  ],
  "References": [
    {
      "Reference": "http://seclists.org/oss-sec/2018/q3/142"
    }
  ]
}
