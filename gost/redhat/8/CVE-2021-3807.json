{
  "ThreatSeverity": "Moderate",
  "PublicDate": "2021-09-17T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2021-3807 nodejs-ansi-regex: Regular expression denial of service (ReDoS) matching ANSI escape codes",
    "id": "2007557",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2007557"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "Iava": "",
  "Cwe": "CWE-400",
  "Statement": "This flaw requires crafted invalid ANSI escape codes in order to be exploited and only allows for denial of service of applications on the client side, hence the impact has been rated as Moderate.\nIn Red Hat Virtualization and Red Hat Quay some components use a vulnerable version of ansi-regex. However, all frontend code is executed on the client side. As the maximum impact of this vulnerability is denial of service in the client, the vulnerability is rated Moderate for those products.\nOpenShift Container Platform 4 (OCP) ships affected version of ansi-regex in the ose-metering-hadoop container, however the metering operator is deprecated since 4.6[1]. This issue is not currently planned to be addressed in future updates and hence hadoop container has been marked as 'will not fix'.\nAdvanced Cluster Management for Kubernetes (RHACM) ships the affected version of ansi-regex in several containers, however the impact of this vulnerability is deemed low as it would result in an authenticated slowing down their own user interface. \n[1] https://docs.openshift.com/container-platform/4.6/metering/metering-about-metering.html",
  "Acknowledgement": "",
  "Mitigation": "",
  "AffectedRelease": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-12-16T00:00:00Z",
      "advisory": "RHSA-2021:5171",
      "package": "nodejs:16-8050020211206113934.c5368500",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2022-01-06T00:00:00Z",
      "advisory": "RHSA-2022:0041",
      "package": "rh-nodejs14-nodejs-0:14.18.2-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2022-01-06T00:00:00Z",
      "advisory": "RHSA-2022:0041",
      "package": "rh-nodejs14-nodejs-nodemon-0:2.0.3-6.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "nodejs:12/nodejs",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "nodejs:12/nodejs-nodemon",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "nodejs:14/nodejs",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "nodejs:14/nodejs-nodemon",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "Name": "CVE-2021-3807",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "ansi-regex is vulnerable to Inefficient Regular Expression Complexity"
    },
    {
      "Detail": "A regular expression denial of service (ReDoS) vulnerability was found in nodejs-ansi-regex. This could possibly cause an application using ansi-regex to use an excessive amount of CPU time when matching crafted ANSI escape codes."
    }
  ],
  "References": [
    {
      "Reference": "https://huntr.dev/bounties/5b3cf33b-ede0-4398-9974-800876dfd994"
    }
  ]
}
