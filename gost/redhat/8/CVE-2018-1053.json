{
  "ThreatSeverity": "Moderate",
  "PublicDate": "2018-02-08T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2018-1053 postgresql: pg_upgrade creates file of sensitive metadata under prevailing umask",
    "id": "1539619",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1539619"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "6.7",
    "cvss3_scoring_vector": "CVSS:3.0/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "Iava": "",
  "Cwe": "CWE-377",
  "Statement": "This issue affects the versions of PostgreSQL 9.x as shipped with Red Hat Satellite 5.x and CloudForms 5.x. Red Hat Product Security has rated this issue as having security impact of Moderate. A future update may address this issue. For additional information, refer to the Issue Severity Classification: https://access.redhat.com/security/updates/classification/.",
  "Acknowledgement": "Red Hat would like to thank the PostgreSQL project for reporting this issue. Upstream acknowledges Tom Lane as the original reporter.",
  "Mitigation": "",
  "AffectedRelease": [
    {
      "product_name": "CloudForms Management Engine 5.9",
      "release_date": "2018-12-13T00:00:00Z",
      "advisory": "RHSA-2018:3816",
      "package": "cfme-0:5.9.6.5-3.el7cf",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "CloudForms Management Engine 5.9",
      "release_date": "2018-12-13T00:00:00Z",
      "advisory": "RHSA-2018:3816",
      "package": "cfme-amazon-smartstate-0:5.9.6.5-2.el7cf",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "CloudForms Management Engine 5.9",
      "release_date": "2018-12-13T00:00:00Z",
      "advisory": "RHSA-2018:3816",
      "package": "cfme-appliance-0:5.9.6.5-1.el7cf",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "CloudForms Management Engine 5.9",
      "release_date": "2018-12-13T00:00:00Z",
      "advisory": "RHSA-2018:3816",
      "package": "cfme-gemset-0:5.9.6.5-2.el7cf",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "CloudForms Management Engine 5.9",
      "release_date": "2018-12-13T00:00:00Z",
      "advisory": "RHSA-2018:3816",
      "package": "dbus-api-service-0:1.0.1-3.1.el7cf",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "CloudForms Management Engine 5.9",
      "release_date": "2018-12-13T00:00:00Z",
      "advisory": "RHSA-2018:3816",
      "package": "httpd-configmap-generator-0:0.2.2-1.2.el7cf",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "CloudForms Management Engine 5.9",
      "release_date": "2018-12-13T00:00:00Z",
      "advisory": "RHSA-2018:3816",
      "package": "postgresql96-0:9.6.10-1PGDG.el7at",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-0:9.5.14-1.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-0:9.6.10-1.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6.7 EUS",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-0:9.5.14-1.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6.7 EUS",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-0:9.6.10-1.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-0:9.5.14-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-0:9.6.10-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.3 EUS",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-0:9.5.14-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.3 EUS",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-0:9.6.10-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-0:9.5.14-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-0:9.6.10-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-0:9.5.14-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-0:9.6.10-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "Name": "CVE-2018-1053",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "In postgresql 9.3.x before 9.3.21, 9.4.x before 9.4.16, 9.5.x before 9.5.11, 9.6.x before 9.6.7 and 10.x before 10.2, pg_upgrade creates file in current working directory containing the output of `pg_dumpall -g` under umask which was in effect when the user invoked pg_upgrade, and not under 0077 which is normally used for other temporary files. This can allow an authenticated attacker to read or modify the one file, which may contain encrypted or unencrypted database passwords. The attack is infeasible if a directory mode blocks the attacker searching the current working directory or if the prevailing umask blocks the attacker opening the file."
    },
    {
      "Detail": "This release of CloudForms corrects an issue invoked when running pg_upgrade by which attackers could read or modify the output of `pg_dumpall -g` in the current working directory. With this release, any attack is rendered infeasible as the directory mode blocks an intruder from searching the current working directory, and the prevailing umask prevents attackers from opening the file."
    }
  ],
  "References": [
    {
      "Reference": "https://www.postgresql.org/about/news/1829/"
    }
  ]
}
