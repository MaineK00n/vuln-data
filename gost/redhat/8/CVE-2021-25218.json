{
  "ThreatSeverity": "Important",
  "PublicDate": "2021-08-18T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2021-25218 bind: Too strict assertion check could be triggered when responses require UDP fragmentation if RRL is in use",
    "id": "1995312",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1995312"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "Iava": "",
  "Cwe": "CWE-617",
  "Statement": "An attacker may abuse the Path MTU discovery (PMTUD) protocol to trick bind into exceeding the interface MTU. Response Rate Limiting (RRL) is not enabled by default for user defined views nor the builtin one, but it is enabled by default for the default builtin CHAOS class view, which bind uses to provide various information.\nThis issue did not affect the versions of bind as shipped with Red Hat Enterprise Linux 6, 7, and 8 as they provide an older version of the code which does not allow to trigger the assertion.",
  "Acknowledgement": "",
  "Mitigation": "Disabling RRL in all views, including the builtin CHAOS class view, prevents the faulty assertion from being reached in the vulnerable versions of bind. To do that you can remove `rate-limit` from your named.conf files and provide a replacement for the builtin CHAOS view, like the one below:\n```\nview override_bind chaos {\nrecursion no;\nnotify no;\nallow-new-zones no;\nmax-cache-size 2M;\nzone \"version.bind\" chaos {\ntype primary;\ndatabase \"_builtin version\";\n};\nzone \"hostname.bind\" chaos {\ntype primary;\ndatabase \"_builtin hostname\";\n};\nzone \"authors.bind\" chaos {\ntype primary;\ndatabase \"_builtin authors\";\n};\nzone \"id.server\" chaos {\ntype primary;\ndatabase \"_builtin id\";\n};\n};\n```",
  "AffectedRelease": [],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "bind",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "Name": "CVE-2021-25218",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "In BIND 9.16.19, 9.17.16. Also, version 9.16.19-S1 of BIND Supported Preview Edition When a vulnerable version of named receives a query under the circumstances described above, the named process will terminate due to a failed assertion check. The vulnerability affects only BIND 9 releases 9.16.19, 9.17.16, and release 9.16.19-S1 of the BIND Supported Preview Edition."
    },
    {
      "Detail": "A flaw was found in bind. An assertion failure is triggered, resulting in termination of the named server process, if named attempts to respond over UDP with a response that is larger than the current effective interface maximum transmission unit (MTU), and if response-rate limiting (RRL) is active. The highest threat from this vulnerability is to system availability."
    }
  ],
  "References": [
    {
      "Reference": "https://kb.isc.org/docs/cve-2021-25218"
    }
  ]
}
