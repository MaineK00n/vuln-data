{
  "ThreatSeverity": "Moderate",
  "PublicDate": "2021-12-10T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2021-4104 log4j: Remote code execution in Log4j 1.x when application is configured to use JMSAppender",
    "id": "2031667",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2031667"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "Iava": "",
  "Cwe": "CWE-20",
  "Statement": "Based on the conditions to be exploitable (see details below), the risk is much lower than Log4j 2.x and Red Hat has assessed this to be Moderate severity. This flaw has been filed for Log4j 1.x, and the corresponding flaw information for Log4j 2.x is available at: https://access.redhat.com/security/cve/CVE-2021-44228\nNote this flaw ONLY affects applications which are specifically configured to use JMSAppender, which is not the default, or when the attacker has write access to the Log4j configuration for adding JMSAppender to the attacker's JNDI LDAP endpoint. \nIf the Log4j configuration is set TopicBindingName or TopicConnectionFactoryBindingName configurations allowing JMSAppender to perform JNDI requests that result in remote code execution in a similar fashion to CVE-2021-44228 Log4j 2.x, Log4j 1.x is vulnerable. However, the attack vector is reduced as it depends on having write access, which is not a standard configuration rather than untrusted user input. These are sufficient factors beyond the attacker's control.\nThe tomcat package shipped with Red Hat Enterprise Linux does not include log4j but it does include a default configuration for log4j, log4j.properties, which could be used with tomcat if users choose to install and configure the library. The JMSAppender is not enabled by default, and the permissions of the file can only be modified as root.\nRed Hat Virtualization ships log4j12-1.2.17, but it is used and configured in a way which makes this flaw not possible to exploit. Therefore impact is rated Low.",
  "Acknowledgement": "",
  "Mitigation": "These are the possible mitigations for this flaw for releases version 1.x:\n- Comment out or remove JMSAppender in the Log4j configuration if it is used\n- Remove the JMSAppender class from the classpath. For example:\n```\nzip -q -d log4j-*.jar org/apache/log4j/net/JMSAppender.class\n```\n- Restrict access for the OS user on the platform running the application to prevent modifying the Log4j configuration by the attacker.",
  "AffectedRelease": [
    {
      "product_name": "Red Hat Enterprise Linux 6 Extended Lifecycle Support",
      "release_date": "2021-12-20T00:00:00Z",
      "advisory": "RHSA-2021:5206",
      "package": "log4j-0:1.2.14-6.5.el6_10",
      "cpe": "cpe:/o:redhat:rhel_els:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2021-12-20T00:00:00Z",
      "advisory": "RHSA-2021:5206",
      "package": "log4j-0:1.2.17-17.el7_4",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.6",
      "release_date": "2021-12-16T00:00:00Z",
      "advisory": "RHSA-2021:5141",
      "package": "openshift4/ose-metering-hadoop:v4.6.0-202112150545.p0.gf381145.assembly.art3595",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.6",
      "release_date": "2021-12-16T00:00:00Z",
      "advisory": "RHSA-2021:5141",
      "package": "openshift4/ose-metering-presto:v4.6.0-202112150545.p0.g190688a.assembly.art3595",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.6",
      "release_date": "2021-12-16T00:00:00Z",
      "advisory": "RHSA-2021:5186",
      "package": "openshift4/ose-metering-hive:v4.6.0-202112160147.p0.gf139e12.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.6::el8"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.7",
      "release_date": "2021-12-16T00:00:00Z",
      "advisory": "RHSA-2021:5184",
      "package": "openshift4/ose-metering-hive:v4.7.0-202112160422.p0.g6a2b6aa.assembly.4.7.40",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.7",
      "release_date": "2021-12-16T00:00:00Z",
      "advisory": "RHSA-2021:5107",
      "package": "openshift4/ose-metering-hadoop:v4.7.0-202112150631.p0.g6046504.assembly.4.7.40",
      "cpe": "cpe:/a:redhat:openshift:4.7::el8"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.7",
      "release_date": "2021-12-16T00:00:00Z",
      "advisory": "RHSA-2021:5107",
      "package": "openshift4/ose-metering-presto:v4.7.0-202112150631.p0.gd502108.assembly.4.7.40",
      "cpe": "cpe:/a:redhat:openshift:4.7::el8"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.8",
      "release_date": "2021-12-15T00:00:00Z",
      "advisory": "RHSA-2021:5148",
      "package": "openshift4/ose-metering-hadoop:v4.8.0-202112150431.p0.gebd9cb4.assembly.art3599",
      "cpe": "cpe:/a:redhat:openshift:4.8::el8"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.8",
      "release_date": "2021-12-15T00:00:00Z",
      "advisory": "RHSA-2021:5148",
      "package": "openshift4/ose-metering-presto:v4.8.0-202112150431.p0.g4b934ae.assembly.art3599",
      "cpe": "cpe:/a:redhat:openshift:4.8::el8"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.8",
      "release_date": "2021-12-16T00:00:00Z",
      "advisory": "RHSA-2021:5183",
      "package": "openshift4/ose-metering-hive:v4.8.0-202112160147.p0.g5672016.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.8::el8"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2021-12-22T00:00:00Z",
      "advisory": "RHSA-2021:5269",
      "package": "rh-maven36-log4j12-0:1.2.17-23.3.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "parfait:0.5/log4j12",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "Name": "CVE-2021-4104",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "JMSAppender in Log4j 1.2 is vulnerable to deserialization of untrusted data when the attacker has write access to the Log4j configuration. The attacker can provide TopicBindingName and TopicConnectionFactoryBindingName configurations causing JMSAppender to perform JNDI requests that result in remote code execution in a similar fashion to CVE-2021-44228. Note this issue only affects Log4j 1.2 when specifically configured to use JMSAppender, which is not the default. Apache Log4j 1.2 reached end of life in August 2015. Users should upgrade to Log4j 2 as it addresses numerous other issues from the previous versions."
    },
    {
      "Detail": "A flaw was found in the Java logging library Apache Log4j in version 1.x. JMSAppender in Log4j 1.x is vulnerable to deserialization of untrusted data. This allows a remote attacker to execute code on the server if the deployed application is configured to use JMSAppender and to the attacker's JNDI LDAP endpoint."
    }
  ],
  "References": [
    {
      "Reference": "https://github.com/apache/logging-log4j2/pull/608#issuecomment-990494126\nhttps://github.com/apache/logging-log4j2/pull/608#issuecomment-991723301\nhttps://lists.apache.org/thread/0x4zvtq92yggdgvwfgsftqrj4xx5w0nx\nhttps://www.openwall.com/lists/oss-security/2021/12/13/1"
    }
  ]
}
