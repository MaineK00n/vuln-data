{
  "ThreatSeverity": "Moderate",
  "PublicDate": "2021-07-07T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2021-31810 ruby: FTP PASV command response can cause Net::FTP to connect to arbitrary host",
    "id": "1980126",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1980126"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "5.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
    "status": "verified"
  },
  "Iava": "",
  "Cwe": "CWE-200",
  "Statement": "Red Hat CloudForms 5.11 does not ship Ruby or RubyGem net-ftp and thus not affected by the flaw. RubyGem net-sftp (Ruby implementation of Secure File Transfer Protocol) which product ship is different library component from the affected package.",
  "Acknowledgement": "",
  "Mitigation": "",
  "AffectedRelease": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-08-05T00:00:00Z",
      "advisory": "RHSA-2021:3020",
      "package": "ruby:2.7-8040020210728141159.522a0ee4",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2021-09-20T00:00:00Z",
      "advisory": "RHSA-2021:3559",
      "package": "rh-ruby27-ruby-0:2.7.4-130.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2021-10-25T00:00:00Z",
      "advisory": "RHSA-2021:3982",
      "package": "rh-ruby30-ruby-0:3.0.2-148.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2021-09-20T00:00:00Z",
      "advisory": "RHSA-2021:3559",
      "package": "rh-ruby27-ruby-0:2.7.4-130.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS",
      "release_date": "2021-10-25T00:00:00Z",
      "advisory": "RHSA-2021:3982",
      "package": "rh-ruby30-ruby-0:3.0.2-148.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "ruby:2.5/ruby",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "ruby:2.6/ruby",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "Name": "CVE-2021-31810",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "An issue was discovered in Ruby through 2.6.7, 2.7.x through 2.7.3, and 3.x through 3.0.1. A malicious FTP server can use the PASV response to trick Net::FTP into connecting back to a given IP address and port. This potentially makes curl extract information about services that are otherwise private and not disclosed (e.g., the attacker can conduct port scans and service banner extractions)."
    },
    {
      "Detail": "Ruby's Net::FTP module trusted the IP address included in the FTP server's response to the PASV command. A malicious FTP server could use this to make Ruby applications using the Net::FTP module to connect to arbitrary hosts and use this to perform port scanning or information extraction from systems not accessible from the FTP server."
    }
  ],
  "References": [
    {
      "Reference": "https://www.ruby-lang.org/en/news/2021/07/07/trusting-pasv-responses-in-net-ftp/"
    }
  ]
}
