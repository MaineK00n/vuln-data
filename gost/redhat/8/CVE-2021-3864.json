{
  "ThreatSeverity": "Moderate",
  "PublicDate": "2021-10-20T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2021-3864 kernel: descendant's dumpable setting with certain SUID binaries",
    "id": "2015046",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2015046"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "7.0",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "Iava": "",
  "Cwe": "",
  "Statement": "This issue is rated as having Moderate impact for Red Hat Enterprise Linux 8 because of the core_pattern default setting (both for ABRT and non-ABRT use cases) that doesn't place core dumps relative to current directory.",
  "Acknowledgement": "Red Hat would like to thank Itai Greenhut (Aleph Research by HCL AppScan) for reporting this issue.",
  "Mitigation": "Red Hat Enterprise Linux 6 and 7 default core_pattern setting is \"core\", which places the core dumps into the current working directory. Changing the default settings to use absolute pathnames will prevent this issue from being exploited. When using ABRT, set MakeCompatCore value in /etc/abrt/plugins/CCpp.conf to \"no\" to avoid ABRT falling back to previous core_pattern setting on core dumps.",
  "AffectedRelease": [],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "Name": "CVE-2021-3864",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "A flaw was found in the way the dumpable flag setting was handled when certain SUID binaries executed its descendants. The prerequisite is a SUID binary that sets real UID equal to effective UID, and real GID equal to effective GID. The descendant will then have a dumpable value set to 1. As a result, if the descendant process crashes and core_pattern is set to a relative value, its core dump is stored in the current directory with uid:gid permissions. An unprivileged local user with eligible root SUID binary could use this flaw to place core dumps into root-owned directories, potentially resulting in escalation of privileges."
    }
  ],
  "References": [
    {
      "Reference": "https://www.openwall.com/lists/oss-security/2021/10/20/2"
    }
  ]
}
