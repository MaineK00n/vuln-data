{
  "ThreatSeverity": "Moderate",
  "PublicDate": "2021-09-08T17:37:00Z",
  "Bugzilla": {
    "description": "CVE-2021-40346 haproxy: request smuggling attack or response splitting via duplicate content-length header",
    "id": "2000599",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2000599"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
    "status": "verified"
  },
  "Iava": "",
  "Cwe": "CWE-444",
  "Statement": "",
  "Acknowledgement": "",
  "Mitigation": "To mitigate this problem the following can be added to proxy config:\nhttp-request deny if { req.hdr_cnt(content-length) gt 1 }\nhttp-response deny if { res.hdr_cnt(content-length) gt 1 }",
  "AffectedRelease": [
    {
      "product_name": "Red Hat OpenShift Container Platform 4.8",
      "release_date": "2022-01-05T00:00:00Z",
      "advisory": "RHSA-2021:5208",
      "package": "haproxy-0:2.2.13-2.el7",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.9",
      "release_date": "2021-11-10T00:00:00Z",
      "advisory": "RHSA-2021:4118",
      "package": "cri-o-0:1.22.0-91.rhaos4.9.gitd745cab.el7",
      "cpe": "cpe:/a:redhat:openshift:4.9::el7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.9",
      "release_date": "2021-11-10T00:00:00Z",
      "advisory": "RHSA-2021:4118",
      "package": "haproxy-0:2.2.15-2.el8",
      "cpe": "cpe:/a:redhat:openshift:4.9::el7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.9",
      "release_date": "2021-11-10T00:00:00Z",
      "advisory": "RHSA-2021:4118",
      "package": "openshift-0:4.9.0-202111020225.p0.git.d8c4430.assembly.stream.el7",
      "cpe": "cpe:/a:redhat:openshift:4.9::el7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.9",
      "release_date": "2021-11-10T00:00:00Z",
      "advisory": "RHSA-2021:4118",
      "package": "openshift-kuryr-0:4.9.0-202110281423.p0.git.4595a4e.assembly.stream.el8",
      "cpe": "cpe:/a:redhat:openshift:4.9::el7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.9",
      "release_date": "2021-11-10T00:00:00Z",
      "advisory": "RHSA-2021:4118",
      "package": "openstack-ironic-1:18.1.1-0.20211019162143.e0437cd.el8",
      "cpe": "cpe:/a:redhat:openshift:4.9::el7"
    }
  ],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "haproxy",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    }
  ],
  "Name": "CVE-2021-40346",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "An integer overflow exists in HAProxy 2.0 through 2.5 in htx_add_header that can be exploited to perform an HTTP request smuggling attack, allowing an attacker to bypass all configured http-request HAProxy ACLs and possibly other ACLs."
    },
    {
      "Detail": "Proxy server haproxy has a flaw that can could allow an HTTP request smuggling attack with the goal of bypassing access-control list rules defined by haproxy. The attack was made possible by utilizing an integer overflow vulnerability that allowed reaching an unexpected state in haproxy while parsing an HTTP request. The highest threat from this vulnerability is integrity."
    }
  ],
  "References": [
    {
      "Reference": "\"BUG/MAJOR: htx: fix missing header name length check in htx_add_header/trailer\"\nhttps://www.haproxy.org/download/2.4/src/CHANGELOG"
    }
  ]
}
