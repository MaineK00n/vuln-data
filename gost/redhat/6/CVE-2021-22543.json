{
  "ThreatSeverity": "Important",
  "PublicDate": "2021-05-18T00:00:00Z",
  "Bugzilla": {
    "description": "CVE-2021-22543 kernel: Improper handling of VM_IO|VM_PFNMAP vmas in KVM can bypass RO checks",
    "id": "1965461",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1965461"
  },
  "Cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "Cvss3": {
    "cvss3_base_score": "7.0",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "Iava": "",
  "Cwe": "CWE-863",
  "Statement": "Both Red Hat Enterprise Linux 7 and Red Hat Enterprise Linux 8 leverage udev to set the proper permissions (ugo=rw) of the `/dev/kvm` device, making it accessible to all users. It is worth noting that while the KVM rule is part of the main udev package in Red Hat Enterprise Linux 8, the same rule is shipped with the `qemu-kvm` package in Red Hat Enterprise Linux 7.  In other words, Red Hat Enterprise Linux 7 does not expose `/dev/kvm` to unprivileged users by default, as long as the `qemu-kvm` package is not installed.",
  "Acknowledgement": "",
  "Mitigation": "Red Hat has investigated whether a possible mitigation exists for this issue, and has not been able to identify a practical example. Please update as soon as possible.",
  "AffectedRelease": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3802",
      "package": "kernel-rt-0:3.10.0-1160.45.1.rt56.1185.el7",
      "cpe": "cpe:/a:redhat:rhel_extras_rt:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3768",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3801",
      "package": "kernel-0:3.10.0-1160.45.1.el7",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.2 Advanced Update Support",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3767",
      "package": "kernel-0:3.10.0-327.101.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.3 Advanced Update Support",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3766",
      "package": "kernel-0:3.10.0-514.93.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.3"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.4 Advanced Update Support",
      "release_date": "2021-10-05T00:00:00Z",
      "advisory": "RHSA-2021:3725",
      "package": "kernel-0:3.10.0-693.94.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Advanced Update Support",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3812",
      "package": "kernel-0:3.10.0-957.84.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Telco Extended Update Support",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3812",
      "package": "kernel-0:3.10.0-957.84.1.el7",
      "cpe": "cpe:/o:redhat:rhel_tus:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Update Services for SAP Solutions",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3812",
      "package": "kernel-0:3.10.0-957.84.1.el7",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.6 Update Services for SAP Solutions",
      "release_date": "2021-10-12T00:00:00Z",
      "advisory": "RHSA-2021:3814",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Advanced Update Support",
      "release_date": "2021-10-26T00:00:00Z",
      "advisory": "RHSA-2021:3987",
      "package": "kernel-0:3.10.0-1062.59.1.el7",
      "cpe": "cpe:/o:redhat:rhel_aus:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Telco Extended Update Support",
      "release_date": "2021-10-26T00:00:00Z",
      "advisory": "RHSA-2021:3987",
      "package": "kernel-0:3.10.0-1062.59.1.el7",
      "cpe": "cpe:/o:redhat:rhel_tus:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Update Services for SAP Solutions",
      "release_date": "2021-10-26T00:00:00Z",
      "advisory": "RHSA-2021:3987",
      "package": "kernel-0:3.10.0-1062.59.1.el7",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7.7 Update Services for SAP Solutions",
      "release_date": "2021-10-26T00:00:00Z",
      "advisory": "RHSA-2021:4000",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:rhel_e4s:7.7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-08-10T00:00:00Z",
      "advisory": "RHSA-2021:3088",
      "package": "kernel-rt-0:4.18.0-305.12.1.rt7.84.el8_4",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-08-10T00:00:00Z",
      "advisory": "RHSA-2021:3044",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2021-08-10T00:00:00Z",
      "advisory": "RHSA-2021:3057",
      "package": "kernel-0:4.18.0-305.12.1.el8_4",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Extended Update Support",
      "release_date": "2021-08-17T00:00:00Z",
      "advisory": "RHSA-2021:3173",
      "package": "kernel-0:4.18.0-147.52.1.el8_1",
      "cpe": "cpe:/o:redhat:rhel_eus:8.1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.1 Extended Update Support",
      "release_date": "2021-08-17T00:00:00Z",
      "advisory": "RHSA-2021:3181",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:rhel_eus:8.1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-08-31T00:00:00Z",
      "advisory": "RHSA-2021:3375",
      "package": "kernel-rt-0:4.18.0-193.64.1.rt13.115.el8_2",
      "cpe": "cpe:/a:redhat:rhel_extras_rt:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-08-31T00:00:00Z",
      "advisory": "RHSA-2021:3363",
      "package": "kernel-0:4.18.0-193.64.1.el8_2",
      "cpe": "cpe:/o:redhat:rhel_eus:8.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Extended Update Support",
      "release_date": "2021-08-31T00:00:00Z",
      "advisory": "RHSA-2021:3380",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:rhel_eus:8.2"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 7",
      "release_date": "2021-10-20T00:00:00Z",
      "advisory": "RHSA-2021:3943",
      "package": "redhat-release-virtualization-host-0:4.3.19-1.el7ev",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 7",
      "release_date": "2021-10-20T00:00:00Z",
      "advisory": "RHSA-2021:3943",
      "package": "redhat-virtualization-host-0:4.3.19-20211013.0.el7_9",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
      "release_date": "2021-08-19T00:00:00Z",
      "advisory": "RHSA-2021:3235",
      "package": "imgbased-0:1.2.23-1.el8ev",
      "cpe": "cpe:/o:redhat:enterprise_linux:8::hypervisor"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
      "release_date": "2021-08-19T00:00:00Z",
      "advisory": "RHSA-2021:3235",
      "package": "redhat-release-virtualization-host-0:4.4.7-4.el8ev",
      "cpe": "cpe:/o:redhat:enterprise_linux:8::hypervisor"
    },
    {
      "product_name": "Red Hat Virtualization 4 for Red Hat Enterprise Linux 8",
      "release_date": "2021-08-19T00:00:00Z",
      "advisory": "RHSA-2021:3235",
      "package": "redhat-virtualization-host-0:4.4.7-20210804.0.el8_4",
      "cpe": "cpe:/o:redhat:enterprise_linux:8::hypervisor"
    }
  ],
  "PackageState": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    }
  ],
  "Name": "CVE-2021-22543",
  "DocumentDistribution": "",
  "Details": [
    {
      "Detail": "An issue was discovered in Linux: KVM through Improper handling of VM_IO|VM_PFNMAP vmas in KVM can bypass RO checks and can lead to pages being freed while still accessible by the VMM and guest. This allows users with the ability to start and control a VM to read/write random pages of memory and can result in local privilege escalation."
    },
    {
      "Detail": "A flaw was found in the Linux kernelâ€™s KVM implementation, where improper handing of the VM_IO|VM_PFNMAP VMAs in KVM bypasses RO checks and leads to pages being freed while still accessible by the VMM and guest. This flaw allows users who can start and control a VM to read/write random pages of memory, resulting in local privilege escalation. The highest threat from this vulnerability is to confidentiality, integrity, and system availability."
    }
  ],
  "References": [
    {
      "Reference": "https://github.com/google/security-research/security/advisories/GHSA-7wq5-phmq-m584"
    }
  ]
}
