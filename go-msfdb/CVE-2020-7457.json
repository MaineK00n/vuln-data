{
  "Name": "ip6_setpktopt_uaf_priv_esc.rb",
  "Title": "FreeBSD ip6_setpktopt Use-After-Free Privilege Escalation",
  "Description": "This module exploits a race and use-after-free vulnerability in the FreeBSD kernel IPv6 socket handling. A missing synchronization lock in the `IPV6_2292PKTOPTIONS` option handling in `setsockopt` permits racing `ip6_setpktopt` access to a freed `ip6_pktopts` struct. This exploit overwrites the `ip6po_pktinfo` pointer of a `ip6_pktopts` struct in freed memory to achieve arbitrary kernel read/write. This module has been tested successfully on: FreeBSD 9.0-RELEASE #0 (amd64); FreeBSD 9.1-RELEASE #0 r243825 (amd64); FreeBSD 9.2-RELEASE #0 r255898 (amd64); FreeBSD 9.3-RELEASE #0 r268512 (amd64); FreeBSD 12.0-RELEASE r341666 (amd64); and FreeBSD 12.1-RELEASE r354233 (amd64).",
  "CveID": "CVE-2020-7457",
  "Edbs": [
    {
      "ExploitUniqueID": "EDB-48644"
    }
  ],
  "References": [
    {
      "Link": "https://packetstormsecurity.com/files/158341"
    },
    {
      "Link": "https://hackerone.com/reports/826026"
    },
    {
      "Link": "https://bsdsec.net/articles/freebsd-announce-freebsd-security-advisory-freebsd-sa-20-20-ipv6"
    },
    {
      "Link": "https://www.freebsd.org/security/patches/SA-20:20/ipv6.patch"
    },
    {
      "Link": "https://github.com/freebsd/freebsd/blob/master/sys/netinet6/ip6_var.h"
    },
    {
      "Link": "https://github.com/freebsd/freebsd/blob/master/sys/netinet6/ip6_output.c"
    },
    {
      "Link": "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/freebsd/local/ip6_setpktopt_uaf_priv_esc.rb"
    }
  ]
}
