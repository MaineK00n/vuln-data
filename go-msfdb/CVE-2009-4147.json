{
  "Name": "rtld_execl_priv_esc.rb",
  "Title": "FreeBSD rtld execl() Privilege Escalation",
  "Description": "This module exploits a vulnerability in the FreeBSD run-time link-editor (rtld). The rtld `unsetenv()` function fails to remove `LD_*` environment variables if `__findenv()` fails. This can be abused to load arbitrary shared objects using `LD_PRELOAD`, resulting in privileged code execution. This module has been tested successfully on: FreeBSD 7.2-RELEASE (amd64); and FreeBSD 8.0-RELEASE (amd64).",
  "CveID": "CVE-2009-4147",
  "Edbs": [],
  "References": [
    {
      "Link": "http://www.securityfocus.com/bid/37154"
    },
    {
      "Link": "https://seclists.org/fulldisclosure/2009/Nov/371"
    },
    {
      "Link": "https://c-skills.blogspot.com/2009/11/always-check-return-value.html"
    },
    {
      "Link": "https://lists.freebsd.org/pipermail/freebsd-announce/2009-December/001286.html"
    },
    {
      "Link": "https://xorl.wordpress.com/2009/12/01/freebsd-ld_preload-security-bypass/"
    },
    {
      "Link": "https://securitytracker.com/id/1023250"
    },
    {
      "Link": "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/freebsd/local/rtld_execl_priv_esc.rb"
    }
  ]
}
