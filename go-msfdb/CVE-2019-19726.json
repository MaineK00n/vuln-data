{
  "Name": "dynamic_loader_chpass_privesc.rb",
  "Title": "OpenBSD Dynamic Loader chpass Privilege Escalation",
  "Description": "This module exploits a vulnerability in the OpenBSD `ld.so` dynamic loader (CVE-2019-19726). The `_dl_getenv()` function fails to reset the `LD_LIBRARY_PATH` environment variable when set with approximately `ARG_MAX` colons. This can be abused to load `libutil.so` from an untrusted path, using `LD_LIBRARY_PATH` in combination with the `chpass` set-uid executable, resulting in privileged code execution. This module has been tested successfully on: OpenBSD 6.1 (amd64); and OpenBSD 6.6 (amd64)",
  "CveID": "CVE-2019-19726",
  "Edbs": [
    {
      "ExploitUniqueID": "EDB-47780"
    }
  ],
  "References": [
    {
      "Link": "https://blog.qualys.com/laws-of-vulnerabilities/2019/12/11/openbsd-local-privilege-escalation-vulnerability-cve-2019-19726"
    },
    {
      "Link": "https://www.qualys.com/2019/12/11/cve-2019-19726/local-privilege-escalation-openbsd-dynamic-loader.txt"
    },
    {
      "Link": "https://www.openwall.com/lists/oss-security/2019/12/11/9"
    },
    {
      "Link": "https://github.com/bcoles/local-exploits/blob/master/CVE-2019-19726/openbsd-dynamic-loader-chpass"
    },
    {
      "Link": "https://ftp.openbsd.org/pub/OpenBSD/patches/6.6/common/013_ldso.patch.sig"
    },
    {
      "Link": "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/openbsd/local/dynamic_loader_chpass_privesc.rb"
    }
  ]
}
